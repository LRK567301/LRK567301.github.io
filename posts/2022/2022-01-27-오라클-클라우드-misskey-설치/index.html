<!DOCTYPE html>
<html lang="ko-kr"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   <meta name="description" content="mastodon으로 셀프호스팅 SNS의 존재를 알고 계속 끌리긴 했다. 2020년대에 들어서 모바일 접근성도 애매한 게시판을 굴리는게 간질간질했거든. 하지만 도커 이미지도 있길래 도전해본 마스트돈은 빌드부터 막히는데 공식 문서는 도커 페이지만 던져주고 끝이고 리노드 같은 대형 VPS의 친절한 가이드도 빌드가 된 게 전제라 답이 없었다. 게시판과 SNS는 다른 거긴 하니 그땐 그러려니 하고 지나갔고 잊혀졌어.
그 이후로도 페디버스 연합을 재밌게 구경하기만 했는데 오늘 갑자기 또 뽐이 왔어. 리버시 게임도 해주는 아이쨩이 감성을 너무 제대로 자극하잖아? 너무 친근한 모델이잖아? 당장 내 프로필이랑도 친척이잖아? 예쁘고, 화려하고, 재밌고, 친근해.">  

  <title>
    
      [오라클 클라우드] Misskey 설치
    
  </title>


  <link rel="shortcut icon" type="image/x-icon" href="/" />
  
  
  
  <link rel="stylesheet" href="/css/main.de67f9cd0aacf98648d0c0d4796ad0cd856635e2a60036ee14189fcbcc2b1a4c7d6d5e94e7d859565e0f840a9674885e8e841a2c0a8e5dd44c055b640ebaaf1c.css" integrity="sha512-3mf5zQqs&#43;YZI0MDUeWrQzYVmNeKmADbuFBify8wrGkx9bV6U59hZVl4PhAqWdIhejoQaLAqOXdRMBVtkDrqvHA==" />
  
</head>
<body a="auto">
        <main class="page-content" aria-label="Content">
            <div class="w">
                <div class="post-meta">
                    <a href="/">..</a>

                    <p>
                        <time datetime="2022-01-27 09:45:00 &#43;0900 KST">
                            2022-01-27
                        </time>
                    </p>
                </div>

<article>
    <h1>[오라클 클라우드] Misskey 설치</h1>

    

    <p>mastodon으로 셀프호스팅 SNS의 존재를 알고 계속 끌리긴 했다. 2020년대에 들어서 모바일 접근성도 애매한 게시판을 굴리는게 간질간질했거든. 하지만 도커 이미지도 있길래 도전해본 마스트돈은 빌드부터 막히는데 공식 문서는 도커 페이지만 던져주고 끝이고 리노드 같은 대형 VPS의 친절한 가이드도 빌드가 된 게 전제라 답이 없었다. 게시판과 SNS는 다른 거긴 하니 그땐 그러려니 하고 지나갔고 잊혀졌어.</p>
<p>그 이후로도 페디버스 연합을 재밌게 구경하기만 했는데 오늘 갑자기 또 뽐이 왔어. 리버시 게임도 해주는 <a href="https://xn--931a.moe/">아이쨩</a>이 감성을 너무 제대로 자극하잖아? 너무 친근한 모델이잖아? 당장 내 프로필이랑도 친척이잖아? 예쁘고, 화려하고, 재밌고, 친근해.</p>
<p>당연히 도커 이미지도 있는데 단순 용량만 비교해도 마스트돈(<a href="https://hub.docker.com/r/tootsuite/mastodon/tags">610MB</a>)의 반(<a href="https://hub.docker.com/r/misskey/misskey/tags">268MB</a>). 프로그램 자체의 무게감도 훨씬 가벼워 보인다.</p>
<p><a href="https://github.com/misskey-dev/misskey">https://github.com/misskey-dev/misskey</a></p>
<p>도커라는 은총 덕에 설치 방법은 정말 쉽다. 쉬운데, 여기서도 docker-compose build야? 아니 이미지 놔두고 진짜&hellip;..혹시나 했더니 역시나 빌드하다 터지더라. 진행 좀 되다 멈추길래 오라클 프리 티어의 성능이 소박해서 그런가 싶어 밤새 놔두니 쪼끔 더 진행되고 터졌더라. 역시 이건 안 돼. 그나마 그 상태에서도 Ctrl+C로 작업 취소는 되어서 다행. 취소조차 한동안 멈춰있긴 했지만.</p>
<p><a href="https://misskey-hub.net/docs/install/bash.html#systemd-or-docker">https://misskey-hub.net/docs/install/bash.html#systemd-or-docker</a></p>
<p>때려칠까 하다 문서를 더 훑어보니 docker-compose만으로 미스키를 굴리는 방법을 외부 링크로 소개해뒀더라. 이거 못 봤으면 던졌을텐데.</p>
<p><a href="https://gist.github.com/mamemomonga/5549bb69cad8e5618e5527593d4890e0">https://gist.github.com/mamemomonga/5549bb69cad8e5618e5527593d4890e0</a></p>
<p>웹서버 구축은 볼 필요 없다. 도커를 쓰면 <a href="https://hub.docker.com/r/jlesage/nginx-proxy-manager">Nginx Proxy Manager</a>도 당연히 쓸텐데 걔가 SSL/리버스 프록시/웹소켓까지 다 해주니까. 적당한 곳에 misskey 폴더 하나 만들고 그 안에서 진행하면 돼.</p>
<pre tabindex="0"><code>mkdir etc
mkdir var
</code></pre><p>etc/docker.env</p>
<pre tabindex="0"><code>POSTGRES_PASSWORD=dbpassword
POSTGRES_USER=misskey
POSTGRES_DB=misskey
</code></pre><p>etc/misskey.yaml</p>
<pre tabindex="0"><code>url: https://example.tld/
db:
  host: db
  port: 5432
  db: misskey
  user: misskey
  pass: dbpassword
redis:
  host: redis
  port: 6379
id: &#39;aid&#39;
port: 3000
</code></pre><p>설정 폴더 및 파일부터 생성. POSTGRES_PASSWORD는 적당히 바꿔주자.</p>
<p>docker-compose.yaml</p>
<pre tabindex="0"><code>version: &#34;3&#34;

services:
  web:
    image: misskey/misskey:12.101.1
    restart: always
    links:
      - db
      - redis
    ports:
      - &#34;127.0.0.1:3000:3000&#34;
    networks:
      - internal_network
      - external_network
    env_file:
      - ./etc/docker.env
    volumes:
      - ./var/files:/misskey/files
      - ./etc/misskey.yaml:/misskey/.config/default.yml:ro

  redis:
    restart: always
    image: redis:4.0-alpine
    networks:
      - internal_network
    volumes:
      - ./var/redis:/data

  db:
    restart: always
    image: postgres:12.2-alpine
    networks:
      - internal_network
    env_file:
      - ./etc/docker.env
    volumes:
      - ./var/db:/var/lib/postgresql/data

networks:
  internal_network:
    internal: true
  external_network:
</code></pre><p><a href="https://hub.docker.com/r/misskey/misskey/tags">버전 태그</a>를 참조해 docker-compose up. 이렇게 빨리 끝날걸 돌아서 왔네. 타임라인 실시간 갱신을 위해 NPM에서 리버스 프록시 및 웹소켓까지 체크해주고 잠시 시간을 두고 미스키 접속, 다음은 하라는 대로 하면 된다. 관리자 계정 생성하고, 인스턴스-시큐리티에 들어가서 아무나 가입 못 하게 일단 막고.</p>
<p>갖고 놀아보니 재밌어. 예쁘고, 500자나 쓸 수 있고, 귀찮게 텍스트 안 쓰고 이모티콘만으로 반응할 수 있고, 업로드한 파일이 모이는 미스키 드라이브도 괜찮고, 위젯도 있고, Milktea 같은 안드로이드 앱도 있고, 아이쨩도 있어. 아이쨩을 꼭 설치하지 않아도 위젯에서 이쪽을 봐줘. 귀여워.</p>
<p>그런데 딱 취미네. SNS 혼자 써서 뭐해&hellip;.일기장으로 쓸 거면 노트앱을 쓰던가 SNS 잠금계정을 쓰지. 기존 게시판을 이쪽으로 옮겨올 수 있는 것도 아니니까. 쓰던 거 씁시다.</p>

</article>

            </div>
        </main>
    </body></html>
